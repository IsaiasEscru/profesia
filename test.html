<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Vocacional - ProfesIA</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
      import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyC84CZet86uBU5WoeTFjJhK_sGWNUjmkU",
        authDomain: "profesia-3db68.firebaseapp.com",
        projectId: "profesia-3db68",
        storageBucket: "profesia-3db68.appspot.com",
        messagingSenderId: "834026103993",
        appId: "1:834026103993:web:aa8601d98bb7899dbaa768"
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      window.enviarRespuestas = async function () {
        const form = document.getElementById("test-form");
        const data = new FormData(form);
        let total = 0;
        for (let valor of data.values()) {
          total += parseInt(valor);
        }

        let perfil = "";
        let carreras = [];

        if (total <= 90) {
          perfil = "Perfil práctico: carreras técnicas, operativas, logística";
          carreras = ["Técnico en electricidad", "Soldadura industrial", "Operador de maquinaria pesada"];
        } else if (total <= 135) {
          perfil = "Perfil analítico: ingenierías, finanzas, programación";
          carreras = ["Ingeniería en sistemas", "Actuaría", "Economía"];
        } else if (total <= 165) {
          perfil = "Perfil social: psicología, educación, trabajo social";
          carreras = ["Psicología", "Pedagogía", "Trabajo social"];
        } else {
          perfil = "Perfil creativo: diseño, publicidad, arte, comunicación";
          carreras = ["Diseño gráfico", "Publicidad", "Comunicación visual"];
        }

        const resultado = document.getElementById("resultado");
        const perfilTexto = document.getElementById("perfil");
        const carrerasLista = document.getElementById("carreras");
        perfilTexto.textContent = perfil;
        carrerasLista.innerHTML = "";
        carreras.forEach(c => {
          const li = document.createElement("li");
          li.classList = "list-disc ml-5 mt-1 text-gray-700";
          li.textContent = c;
          carrerasLista.appendChild(li);
        });
        resultado.classList.remove("hidden");

        try {
          const curp = localStorage.getItem("curp") || "no_registrado";
          await addDoc(collection(db, "resultados_test"), {
            curp,
            puntaje: total,
            perfil,
            carreras,
            fecha: new Date().toISOString()
          });
          console.log("Guardado en Firestore exitosamente.");
        } catch (error) {
          console.error("Error al guardar en Firestore:", error);
        }
      }
    </script>
  </head>
  <body class="bg-gray-50 text-gray-800 font-sans">
    <main class="container mx-auto px-4 py-10">
      <section class="max-w-2xl mx-auto">
        <h1 class="text-3xl font-bold text-center mb-6">Test Vocacional</h1>
        <form id="test-form" class="space-y-6" onsubmit="event.preventDefault(); enviarRespuestas();">
          <div class="space-y-4" id="preguntas"></div>
          <button
            type="submit"
            class="w-full bg-indigo-700 text-white py-2 rounded hover:bg-indigo-800"
          >
            Enviar respuestas
          </button>
        </form>

        <div
          id="resultado"
          class="mt-10 p-4 bg-white rounded shadow hidden"
        >
          <h2 class="text-xl font-semibold mb-2">Tu perfil sugerido:</h2>
          <p id="perfil" class="text-gray-700 mb-4"></p>
          <h3 class="font-semibold">Carreras sugeridas:</h3>
          <ul id="carreras" class="mt-2"></ul>
        </div>
      </section>
    </main>

    <script>
      const preguntas = [
        "Me gusta resolver problemas matemáticos complejos",
        "Prefiero trabajar en equipo que solo",
        "Me interesa saber cómo funciona el cuerpo humano",
        "Disfruto planear y organizar actividades",
        "Me gusta ayudar a las personas a superar sus dificultades",
        "Prefiero tareas prácticas sobre teóricas",
        "Me interesa el mundo de la tecnología",
        "Tengo facilidad para hablar en público",
        "Me veo liderando un equipo en el futuro",
        "Me interesa trabajar con niños o jóvenes",
        "Disfruto tareas que requieren creatividad visual",
        "Me interesa resolver conflictos y mediar problemas",
        "Valoro el orden y la precisión en mi trabajo",
        "Me interesa el diseño de espacios y arquitectura",
        "Me veo emprendiendo mi propio negocio",
        "Me interesa la programación y desarrollo web",
        "Siento empatía con el sufrimiento ajeno",
        "Disfruto aprender nuevos idiomas",
        "Tengo buen manejo del estrés en situaciones críticas",
        "Me gustaría explorar el espacio o trabajar con astronomía",
        "Siento afinidad por la disciplina militar",
        "Me atrae el trabajo con maquinaria o herramientas",
        "Prefiero trabajos con estabilidad a largo plazo",
        "Me gustaría trabajar en salud mental",
        "Tengo facilidad para redactar y escribir contenido",
        "Me interesa la investigación científica",
        "Me gustaría trabajar en el extranjero",
        "Disfruto la atención al cliente",
        "Tengo interés por las leyes y justicia social",
        "Me interesa la nutrición y el bienestar físico",
        "Soy creativo con ideas para marketing",
        "Me gusta el análisis de datos y estadísticas",
        "Siento que tengo habilidades artísticas",
        "Disfruto el trabajo físico o deportivo",
        "Me interesa la inteligencia artificial",
        "Valoro el crecimiento espiritual y personal"
      ];

      const preguntasDiv = document.getElementById("preguntas");

      preguntas.forEach((texto, i) => {
        const preguntaHTML = `
        <div>
          <label class="block font-medium mb-1">${i + 1}. ${texto}</label>
          <select
            name="p${i}"
            required
            class="w-full border border-gray-300 rounded px-3 py-2"
          >
            <option value="">Selecciona una respuesta</option>
            <option value="1">Totalmente en desacuerdo</option>
            <option value="2">En desacuerdo</option>
            <option value="3">Neutral</option>
            <option value="4">De acuerdo</option>
            <option value="5">Totalmente de acuerdo</option>
          </select>
        </div>`;
        preguntasDiv.insertAdjacentHTML("beforeend", preguntaHTML);
      });
    </script>
  </body>
</html>


